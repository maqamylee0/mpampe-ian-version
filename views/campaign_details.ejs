
<% extend('layout') %>
<%- include('common/format_currency') %>

<!-- Start Main Banner Area -->
<div class="main-banner item-bg-one inner-banner">
    <div class="d-table">
      <div class="d-table-cell">
        <div class="container">
          <div class="row">
            <div class="col-lg-12 col-md-12">
              <h2>Campaign Details</h2>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <section class="campaign_detail pt60 pb60 blog-single-section ">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-sm-12 col-xs-12"> 
          
          <!-- Nav tabs -->
          <div class="card">
            <ul class="nav nav-tabs" role="tablist">
              <li role="presentation" class="active"><a class="active" href="campaign_detail.html#Campaign" aria-controls="Campaign" role="tab" data-toggle="tab"><span>Campaign Home</span></a></li>
              <li role="presentation"><a href="campaign_detail.html#Backer" aria-controls="Backer" role="tab" data-toggle="tab">Â  <span>Backer</span></a></li>
              <li role="presentation"><a href="campaign_detail.html#Updates" aria-controls="Updates" role="tab" data-toggle="tab"> <span>Updates</span></a></li>
              <li role="presentation"><a href="campaign_detail.html#FAQ" aria-controls="FAQ" role="tab" data-toggle="tab"> <span>FAQ</span></a></li>
              <li role="presentation"><a href="campaign_detail.html#Comments" aria-controls="Comments" role="tab" data-toggle="tab"><span>Comments</span></a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
              <div role="tabpanel" class="tab-pane active blog-single-section" id="Campaign">
                <div class="row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="blog-content">
                      <div class="post format-standard-image">
                        <div class="entry-media"> <img src="<%= campaign.photo || 'https://dummyimage.com/600x400/f26422/00ffff.png&text=mpampe' %>" alt=""> </div>
                        <ul class="entry-meta">
                          <li><a href="campaign_detail.html#"><i class="far fa-clock"></i><%= new Date(campaign.createdAt).toDateString() %></a></li>
                          <li><a href="campaign_detail.html#"><i class="fas fa-funnel-dollar"></i><%= campaign.category %></a></li>
                          <li><a href="campaign_detail.html#"><i class="fas fa-comments"></i>0</a></li>
                        </ul>
                        <h2><%= campaign.title %></h2>
                     <p><%= campaign.description %></p>
                      </div>
                      <div class="tag-share">
                        <div class="share"> Share: &nbsp;
                          <ul>
                            <li><a target="_Blank" href="https://www.facebook.com"><i class="fab fa-facebook-f"></i></a></li>
                            <li><a target="_Blank" href="https://www.twitter.com"><i class="fab fa-twitter"></i></a></li>
                            <li><a target="_Blank" href="https://www.google.com"><i class="fab fa-google-plus-g"></i></a></li>
                            <li><a target="_Blank" href="https://www.linkedin.com"><i class="fab fa-linkedin-in"></i></a></li>
                            <li><a target="_Blank" href="https://www.instagram.com"><i class="fab fa-instagram"></i></a></li>
                          </ul>
                        </div>
                      </div>
                      <!-- end tag-share -->
                      
                      <div class="author-box">
                        <div class="author-content"> <a href="#" class="author-name"><%= campaign.user.fullName %></a>
                          <div class="socials">
                            <ul class="social-link">
                              <li><a href="campaign_detail.html#"><i class="ti-facebook"></i></a></li>
                              <li><a href="campaign_detail.html#"><i class="ti-twitter-alt"></i></a></li>
                              <li><a href="campaign_detail.html#"><i class="ti-linkedin"></i></a></li>
                              <li><a href="campaign_detail.html#"><i class="ti-instagram"></i></a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      <!-- end author-box -->
                      
                      <div class="more-posts">
                        <div class="previous-post"> <a href="campaign_detail.html#"> <span class="post-control-link"><i class="ti-arrow-circle-left"> </i>Previous Campaign</span> </a> </div>
                        <div class="next-post"> <a href="https://preview.templatehouse.net/getfund/0"> <span class="post-control-link">Next Campaign <i class="ti-arrow-circle-right"></i></span> </a> </div>
                      </div>
                      <!-- end more-posts --> 
                      
                      <!-- end comments-area --> 
                    </div>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="Backer">
                <div class="row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="card mb-4">
                      <div class="card-body"> 
                        <!-- Grid row --> 
                        
                        <!-- Grid row --> 
                        <!--Table-->
                        <table class="table table-striped">
                          <!--Table head-->
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>First Name</th>
                              <th>Last Name</th>
                              <th>Username</th>
                            </tr>
                          </thead>
                          <!--Table head--> 
                          <!--Table body-->
                          <tbody>
                            <tr>
                              <th scope="row">1</th>
                              <td>Mark</td>
                              <td>Otto</td>
                              <td>@mdo</td>
                            </tr>
                            <tr>
                              <th scope="row">2</th>
                              <td>Jacob</td>
                              <td>Thornton</td>
                              <td>@fat</td>
                            </tr>
                            <tr>
                              <th scope="row">3</th>
                              <td>Larry</td>
                              <td>the Bird</td>
                              <td>@twitter</td>
                            </tr>
                            <tr>
                              <th scope="row">1</th>
                              <td>Mark</td>
                              <td>Otto</td>
                              <td>@mdo</td>
                            </tr>
                            <tr>
                              <th scope="row">2</th>
                              <td>Jacob</td>
                              <td>Thornton</td>
                              <td>@fat</td>
                            </tr>
                            <tr>
                              <th scope="row">3</th>
                              <td>Larry</td>
                              <td>the Bird</td>
                              <td>@twitter</td>
                            </tr>
                          </tbody>
                          <!--Table body-->
                        </table>
                        <!--Table--> 
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="Updates">
                <div class="row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="tracking-list">
                      <div class="tracking-item">
                        <div class="tracking-icon status-intransit"> <i class="fas fa-circle"></i>
                        </div>
                        <div class="tracking-date">Aug 10, 2018<span>05:01 PM</span></div>
                        <div class="tracking-content">DESTROYEDPER SHIPPER INSTRUCTION<span>KUALA LUMPUR (LOGISTICS HUB), MALAYSIA, MALAYSIA</span></div>
                      </div>
                      <div class="tracking-item">
                        <div class="tracking-icon status-intransit"> <i class="fas fa-circle"></i> 
                        </div>
                        <div class="tracking-date">Aug 10, 2018<span>11:19 AM</span></div>
                        <div class="tracking-content">SHIPMENT DELAYSHIPPER INSTRUCTION TO DESTROY<span>SHENZHEN, CHINA, PEOPLE'S REPUBLIC</span></div>
                      </div>
                      <div class="tracking-item">
                        <div class="tracking-icon status-intransit"> <i class="fas fa-circle"></i>
                        </div>
                        <div class="tracking-date">Jul 27, 2018<span>04:08 PM</span></div>
                        <div class="tracking-content">DELIVERY ADVICERequest Instruction from ORIGIN<span>KUALA LUMPUR (LOGISTICS HUB), MALAYSIA, MALAYSIA</span></div>
                      </div>
                      <div class="tracking-item">
                        <div class="tracking-icon status-intransit"><i class="fas fa-circle"></i>
                        </div>
                        <div class="tracking-date">Jul 20, 2018<span>05:25 PM</span></div>
                        <div class="tracking-content">Delivery InfoCLOSED-OFFICE/HOUSE CLOSED<span>KUALA LUMPUR (LOGISTICS HUB), MALAYSIA, MALAYSIA</span></div>
                      </div>
                      <div class="tracking-item">
                        <div class="tracking-icon status-outfordelivery"><i class="fas fa-shipping-fast"></i> 
                        </div>
                        <div class="tracking-date">Jul 20, 2018<span>08:58 AM</span></div>
                        <div class="tracking-content">Shipment is out for despatch by KLHB023.<span>KUALA LUMPUR (LOGISTICS HUB), MALAYSIA, MALAYSIA</span></div>
                      </div>
                      <div class="tracking-item">
                        <div class="tracking-icon status-intransit">
                         <i class="fas fa-circle"></i> 
                        </div>
                        <div class="tracking-date">Jul 19, 2018<span>05:42 PM</span></div>
                        <div class="tracking-content">Delivery InfoUNABLE TO ACCESS<span>KUALA LUMPUR (LOGISTICS HUB), MALAYSIA, MALAYSIA</span></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="FAQ">
                <div class="row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="faq">
                      <div class="tab-content" id="faq-tab-content">
                        <div class="tab-pane show active" id="tab1" role="tabpanel" aria-labelledby="tab1">
                          <div class="accordion" id="accordion-tab-1">
                            <div class="card">
                              <div class="card-header" id="accordion-tab-1-heading-1">
                                <h5>
                                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#accordion-tab-1-content-1" aria-expanded="false" aria-controls="accordion-tab-1-content-1">Just once I'd like to eat dinner with a celebrity?</button>
                                </h5>
                              </div>
                              <div class="collapse show" id="accordion-tab-1-content-1" aria-labelledby="accordion-tab-1-heading-1" data-parent="#accordion-tab-1">
                                <div class="card-body">
                                  <p>Yes, if you make it look like an electrical fire. When you do things right, people won't be sure you've done anything at all. I was having the most wonderful dream. Except you were there, and you were there, and you were there! No argument here. Goodbye, cruel world. Goodbye, cruel lamp. Goodbye, cruel velvet drapes, lined with what would appear to be some sort of cruel muslin and the cute little pom-pom curtain pull cords. Cruel though they may be.</p>
                                  <p><strong>Example: </strong>Shut up and get to the point!</p>
                                </div>
                              </div>
                            </div>
                            <div class="card">
                              <div class="card-header" id="accordion-tab-1-heading-2">
                                <h5>
                                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#accordion-tab-1-content-2" aria-expanded="false" aria-controls="accordion-tab-1-content-2">Bender, I didn't know you liked cooking?</button>
                                </h5>
                              </div>
                              <div class="collapse" id="accordion-tab-1-content-2" aria-labelledby="accordion-tab-1-heading-2" data-parent="#accordion-tab-1">
                                <div class="card-body">
                                  <p>That's so cute. Can we have Bender Burgers again? Is the Space Pope reptilian!? I wish! It's a nickel. Bender! Ship! Stop bickering or I'm going to come back there and change your opinions manually!</p>
                                  <p><strong>Example: </strong>Okay, I like a challenge. Is that a cooking show? No argument here.</p>
                                </div>
                              </div>
                            </div>
                            <div class="card">
                              <div class="card-header" id="accordion-tab-1-heading-3">
                                <h5>
                                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#accordion-tab-1-content-3" aria-expanded="false" aria-controls="accordion-tab-1-content-3">My fellow Earthicans?</button>
                                </h5>
                              </div>
                              <div class="collapse" id="accordion-tab-1-content-3" aria-labelledby="accordion-tab-1-heading-3" data-parent="#accordion-tab-1">
                                <div class="card-body">
                                  <p>As I have explained in my book 'Earth in the Balance', and the much more popular 'Harry Potter and the Balance of Earth', we need to defend our planet against pollution. Also dark wizards. Fry, you can't just sit here in the dark listening to classical music.</p>
                                  <p><strong>Example: </strong>Actually, that's still true. Well, let's just dump it in the sewer and say we delivered it.</p>
                                </div>
                              </div>
                            </div>
                            <div class="card">
                              <div class="card-header" id="accordion-tab-1-heading-4">
                                <h5>
                                  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#accordion-tab-1-content-4" aria-expanded="false" aria-controls="accordion-tab-1-content-4">Who am I making this out to?</button>
                                </h5>
                              </div>
                              <div class="collapse" id="accordion-tab-1-content-4" aria-labelledby="accordion-tab-1-heading-4" data-parent="#accordion-tab-1">
                                <div class="card-body">
                                  <p>Morbo can't understand his teleprompter because he forgot how you say that letter that's shaped like a man wearing a hat. Also Zoidberg. Can we have Bender Burgers again? Goodbye, cruel world. Goodbye, cruel lamp. Goodbye, cruel velvet drapes, lined with what would appear to be some sort of cruel muslin and the cute little pom-pom curtain pull cords.</p>
                                  <p><strong>Example: </strong>Cruel though they may be...</p>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="Comments">
                <div class="row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                    <div class="comment-respond">
                      <form method="post" id="commentform" class="comment-form">
                        <div class="form-textarea">
                          <textarea id="comment" placeholder="Write Your Comments..."></textarea>
                        </div>
                        <div class="form-inputs">
                          <input placeholder="Website" type="url">
                          <input placeholder="Name" type="text">
                          <input placeholder="Email" type="email">
                        </div>
                        <div class="form-submit">
                          <input id="submit" value="Post Comment" type="submit">
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-sm-12 col-xs-12">
          <div class="campaign-item">
            <div class="campaign-box"> <a href="campaign_detail.html#" class="category"><%= campaign.category %></a>
              <h3><a href="campaign_detail.html"><%= campaign.title %></a></h3>
              <div class="campaign-description"><%= campaign.shortDescription %></div>
              <div class="campaign-author">by <a class="author-name" href="#"><%= campaign.user.fullName %></a></div>
              <div class="process">
                <div class="progress">
                  <div class="progress-bar" style="width: <%= campaign.percentage %>%;">
                    <div class="progress-value"><span><%= campaign.percentage %></span>%</div>
                  </div>
                </div>
                <div class="process-info">
                  <div class="process-pledged"><span><%= campaign.daysLeft %></span>Days left</div>
                  <div class="process-funded"><span><%= campaign.backers %></span><%= campaign.backers > 1 ? 'Backers': 'Backer' %></div>
                  <div class="process-time">
                    <span>                   
                      <script>
                        document.write(currencyFormatter.format('<%= campaign.funds %>'));
                      </script>
                    </span>Funded
                  </div>
                </div>
                <div style="margin: 10px;">
                  <a href="/transfer">
                    <button class="btn btn-flat btn-dark btn-theme-colored">WITHDRAW</button>
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div class="campaign-item">
            <div class="bg-light-transparent">
              <h4 class="text-uppercase line-bottom">Make a Donation Now!</h4>
              
              <!-- Paypal Both Onetime/Recurring Form Starts -->
              <form id="paypal_donate_form" onsubmit="submitForm(event)">
                <div class="row">
                  <div style="margin: 15px; display: none" id="flashNotice"></div>
                  <% if (!user) { %>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <label><strong>Full name</strong></label>
                        <input
                          type="text"
                          class="form-control"
                          name="donorName"
                          placeholder="Full Name"
                        />
                      </div>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <label><strong>Email</strong></label>
                        <input
                          type="email"
                          class="form-control"
                          name="donorEmail"
                          placeholder="Email Address"
                        />
                      </div>
                    </div>
                    <% } %>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <label><strong>Currency</strong></label>
                      <select name="currency" class="form-control">
                        <option value="">Select Currency</option>
                        <option value="UGX" selected="selected">UGX - Uganda Shillings</option>
                        <option value="USD">USD - U.S. Dollars</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <label><strong>How much do you want to donate?</strong></label>
                      <input name="amount" placeholder="Amount" class="form-control" />
                    </div>
                  </div>
                  <div class="col-sm-12">
                    <div class="form-group">
                      <button type="submit" class="btn btn-flat btn-dark btn-theme-colored">Donate Now</button>
                    </div>
                  </div>
                </div>
              </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
  </section>
  
  <%- include('common/ajax.ejs') %>

<script type="text/javascript">
  function submitForm(event) {
    event.preventDefault();

    const form = document.getElementById("paypal_donate_form");
    const formEntries = new FormData(form).entries();
    const flashNotice = document.getElementById("flashNotice");
    const formData = Object.assign(
      ...Array.from(formEntries, ([x, y]) => ({ [x]: y }))
    );

    postData("/api/v1/donations/fund/<%= campaign.id %>", formData).then((data) => {
      if (data.message) {
        flashNotice.innerHTML = data.message;
        flashNotice.style.display = "block";

        setTimeout(() => {
          flashNotice.innerHTML = "";
          flashNotice.style.display = "none";
        }, 3000);
      } else {
        form.reset();
        alert("Donation received! thank you.");
      }
    });
  }
</script>